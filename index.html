<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>Work Counter</title>

<!-- ICONO APP -->
<link rel="apple-touch-icon" href="icon.png">
<link rel="icon" href="icon.png">

<style>
@font-face {
  font-family: 'Digital';
  src: url('https://fonts.gstatic.com/s/digital7/d-6IYplOFocCacKzxw.ttf');
}

body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: Arial, sans-serif;
}

.app {
  text-align: center;
  padding: 20px;
}

h2 {
  font-size: 12px;
  font-weight: 300;
  margin-bottom: 4px;
  opacity: 0.7;
}

.number {
  font-family: 'Digital';
  font-size: 42px;
}

.big {
  font-size: 64px;
}

.line {
  height: 1px;
  background: #fff;
  opacity: 0.2;
  margin: 20px 0;
}

.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 6px;
}

.day {
  padding: 10px 0;
  border-radius: 6px;
  border: 1px solid #333;
  font-size: 12px;
  cursor: pointer;
}

.day.red {
  background: #400;
}
</style>
</head>

<body>
<div class="app">

  <h2>D√çAS SEGUIDOS</h2>
  <div class="number big" id="streak">0</div>

  <div class="line"></div>

  <h2>TOTAL ‚Ç¨</h2>
  <div class="number big" id="money">0,00</div>

  <div class="line"></div>

  <h2>CALENDARIO</h2>
  <div class="calendar" id="calendar"></div>

</div>

<script>
const PRICE_PER_DAY = 90; // ‚Ç¨ por d√≠a
const calendarEl = document.getElementById("calendar");

let days = JSON.parse(localStorage.getItem("days")) || {};

function save() {
  localStorage.setItem("days", JSON.stringify(days));
}

function renderCalendar() {
  calendarEl.innerHTML = "";
  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth();

  const lastDay = new Date(year, month + 1, 0).getDate();

  for (let d = 1; d <= lastDay; d++) {
    const dateKey = `${year}-${month + 1}-${d}`;
    const div = document.createElement("div");
    div.className = "day";
    div.innerText = d;

    if (days[dateKey] === "off") div.classList.add("red");

    div.onclick = () => {
      days[dateKey] = days[dateKey] === "off" ? "work" : "off";
      save();
      renderCalendar();
      calculate();
    };

    calendarEl.appendChild(div);
  }
}

function calculate() {
  const workedDays = Object.keys(days)
    .filter(d => days[d] !== "off")
    .sort();

  // üí∞ DINERO
  const money = workedDays.length * PRICE_PER_DAY;
  document.getElementById("money").innerText =
    money.toLocaleString("es-ES", { minimumFractionDigits: 2 });

  // üî• RACHA
  let streak = 0;
  if (workedDays.length > 0) {
    let index = workedDays.length - 1;
    streak = 1;

    while (index > 0) {
      const current = new Date(workedDays[index]);
      const prev = new Date(workedDays[index - 1]);
      const diff = (current - prev) / (1000 * 60 * 60 * 24);

      if (diff === 1) {
        streak++;
        index--;
      } else {
        break;
      }
    }
  }

  document.getElementById("streak").innerText = streak;
}

renderCalendar();
calculate();
</script>
</body>
</html>
